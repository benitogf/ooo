<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storage Explorer</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="styles.css">
    <script src="react.min.js"></script>
    <script src="react-dom.min.js"></script>
    <script src="babel.min.js"></script>
    <script src="ooo-client.js"></script>
    <script src="react-json-view.js"></script>
    <script src="api.js"></script>
    <script type="module">
      import { JSONEditor } from './vanilla-jsoneditor.js';
      window.JSONEditor = JSONEditor;
    </script>
</head>
<body>
    <div id="root"></div>
    <script>
      async function loadJSX(files) {
        for (const file of files) {
          const res = await fetch(file);
          const code = await res.text();
          const compiled = Babel.transform(code, { presets: ['react'] }).code;
          const script = document.createElement('script');
          script.textContent = compiled;
          document.body.appendChild(script);
        }
      }
      
      const jsxFiles = [
        'components/Icons.jsx',
        'components/ConfirmModal.jsx',
        'components/AppNav.jsx',
        'components/Breadcrumb.jsx',
        'components/JsonEditorWrapper.jsx',
        'components/StorageList.jsx',
        'components/StorageKeysLive.jsx',
        'components/PushDialog.jsx',
        'components/EditKeyModal.jsx',
        'components/PathNavigatorModal.jsx',
        'components/StateModal.jsx',
        'components/PivotStatus.jsx',
        'components/JsonTreeCell.jsx',
        'components/KeyEditor.jsx',
        'components/KeyEditorLive.jsx',
        'components/StoragePush.jsx',
        'components/SettingsPage.jsx',
        'components/StatePage.jsx',
        'components/ExplorerApp.jsx'
      ];
      
      loadJSX(jsxFiles).then(() => {
        function tryMount() {
          if (window.ExplorerApp && window.JSONEditor && window.Api) {
            ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(window.ExplorerApp));
          } else {
            setTimeout(tryMount, 50);
          }
        }
        tryMount();
      });
    </script>
</body>
</html>
